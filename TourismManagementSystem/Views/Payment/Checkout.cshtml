@model Tourism.DataAccess.Models.Payment

@{
    ViewData["Title"] = "Payment Checkout";
}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-success text-white">
                    <h3 class="mb-0"><i class="bi bi-credit-card"></i> Payment Checkout</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <h5>Booking Summary</h5>
                        <p><strong>Booking ID:</strong> #@Model.BookingId</p>
                        <p><strong>Amount to Pay:</strong> ?@Model.Amount</p>
                    </div>

                    <form asp-action="Checkout" method="post">
                        @Html.AntiForgeryToken()
                        <input type="hidden" asp-for="BookingId" />
                        <input type="hidden" asp-for="Amount" />

                        <h5>Payment Details</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Card Number *</label>
                                <input type="text" class="form-control" placeholder="1234 5678 9012 3456" maxlength="19" required />
                                <div class="form-text">We use secure payment processing</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Cardholder Name *</label>
                                <input type="text" class="form-control" placeholder="Full Name on Card" required />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Expiry Month *</label>
                                <select class="form-select" required>
                                    <option value="">Month</option>
                                    @for (int i = 1; i <= 12; i++)
                                    {
                                        <option value="@i">@i.ToString("00")</option>
                                    }
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Expiry Year *</label>
                                <select class="form-select" required>
                                    <option value="">Year</option>
                                    @for (int year = DateTime.Now.Year; year <= DateTime.Now.Year + 20; year++)
                                    {
                                        <option value="@year">@year</option>
                                    }
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">CVV *</label>
                                <input type="password" class="form-control" placeholder="123" maxlength="4" required />
                            </div>
                        </div>

                        <div class="alert alert-warning">
                            <i class="bi bi-shield-check"></i> <strong>Demo Mode:</strong> This is a simulation. No real payment will be processed.
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a asp-controller="Booking" asp-action="History" class="btn btn-secondary me-md-2">
                                <i class="bi bi-arrow-left"></i> Cancel
                            </a>
                            <button type="submit" class="btn btn-success btn-lg">
                                <i class="bi bi-credit-card"></i> Pay ?@Model.Amount
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Format card number input
            const cardNumberInput = document.querySelector('input[placeholder*="1234"]');
            cardNumberInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                let formattedValue = value.replace(/(\d{4})(?=\d)/g, '$1 ');
                e.target.value = formattedValue;
            });

            // CVV validation
            const cvvInput = document.querySelector('input[placeholder="123"]');
            cvvInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '');
            });
        });
    </script>
}